datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                 Int                  @id @default(autoincrement())
  athleteId          Int                  @unique
  username           String               @unique
  name               String?
  country            String               @default("not specified")
  profile            String               @default("url to default avatar large")
  profileMedium      String               @default("url to default avatar small")
  accountBalance     Int                  @default(0)
  collectedCards     Int                  @default(0)
  inAppSince         DateTime             @default(now())
  lastActive         DateTime             @default(now())
  stravaRefreshToken StravaRefreshToken[]
  stravaAccessToken  StravaAccessToken[]
}

model StravaRefreshToken {
  id               Int    @id @default(autoincrement())
  user             User   @relation(fields: [userAthleteId], references: [athleteId], onDelete: Cascade)
  userAthleteId    Int    @unique
  refreshTokenCode String @unique
  scope            String @default("read")
}

model StravaAccessToken {
  id              Int      @id @default(autoincrement())
  user            User     @relation(fields: [userAthleteId], references: [athleteId], onDelete: Cascade)
  userAthleteId   Int      @unique
  accessTokenCode String   @unique
  expiresAt       DateTime
  scope           String   @default("read")
}
